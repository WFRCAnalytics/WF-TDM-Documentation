<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>WFTDM Documentation - Model Enhancements</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../_pictures/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="https://wfrc.org" class="navbar-brand navbar-brand-logo">
    <img src="../../../_pictures/wf-logo-new-white-t.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html" rel="" target="">
 <span class="menu-text">Overview</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-version-9-series" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Version 9 Series</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-version-9-series">    
        <li>
    <a class="dropdown-item" href="../../../v9x/v900/index.html" rel="" target="">
 <span class="dropdown-text">Version 9.0.0</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-past-versions" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Past Versions</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-past-versions">    
        <li>
    <a class="dropdown-item" href="../../../v8x/v832/index.html" rel="" target="">
 <span class="dropdown-text">Version 8.3.2 - Draft Release</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../v8x/v831/index.html" rel="" target="">
 <span class="dropdown-text">Version 8.3.1 - Draft Release</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../v8x/v830/index.html" rel="" target="">
 <span class="dropdown-text">Version 8.3.0 - Draft Release</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools ms-auto">
    <a href="https://github.com/WFRCAnalytics/TDM-Documentation/tree/gh-pages" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="mailto:sswim@wfrc.org" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-envelope"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><span style="color: #3E6682;font-size: 25px;">**Version 9.0.0**</span></li><li class="breadcrumb-item"><a href="../../../v9x/v900/whats-new/1-overview.html"><span style="color: #3E6682;">**Whats New Document**</span></a></li><li class="breadcrumb-item"><a href="../../../v9x/v900/whats-new/6-modelenhancements.html">6 Model Enhancements</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text"><span style="color: #3E6682;font-size: 25px;"><strong>Version 9.0.0</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/downloads.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Downloads</span></a>
  </div>
</li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text"><span style="color: #3E6682;"><strong>Whats New Document</strong></span></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/1-overview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/2-taz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 Traffic Analysis Zone Updates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/3-sedata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Socioeconomic Data Updates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/4-networks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 Highway &amp; Transit Networks Updates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/5-baseyear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5 Model 2019 Base-Year Updates</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/6-modelenhancements.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">6 Model Enhancements</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/whats-new/7-modelresults.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7 Compare Model Results</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text"><span style="color: #3E6682;"><strong>Model Validation Report</strong></span></span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/validation/1-tripgen.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1 Trip Generation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/validation/2-distribute.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2 Distribution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/validation/3-modechoice.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3 Mode Choice</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../v9x/v900/validation/4-assignhwy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4 Highway Assignment</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="px-0"><hr class="sidebar-divider hi "></li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title"><strong>Section Contents</strong><br>__________________</h2>
   
  <ul class="collapse">
  <li><a href="#distribution" id="toc-distribution" class="nav-link active" data-scroll-target="#distribution">Distribution</a></li>
  <li><a href="#mode-choice" id="toc-mode-choice" class="nav-link" data-scroll-target="#mode-choice">Mode Choice</a></li>
  <li><a href="#assignment" id="toc-assignment" class="nav-link" data-scroll-target="#assignment">Assignment</a></li>
  <li><a href="#miscellaneous-updates" id="toc-miscellaneous-updates" class="nav-link" data-scroll-target="#miscellaneous-updates">Miscellaneous Updates</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Model Enhancements</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="distribution" class="level2">
<h2 class="anchored" data-anchor-id="distribution">Distribution</h2>
<section id="distribution-convergence" class="level3">
<h3 class="anchored" data-anchor-id="distribution-convergence">Distribution Convergence</h3>
<p>The convergence criteria in the <code>1_Distribution.s</code> script was updated.</p>
<p><strong>Trip Table Convergence</strong></p>
<p>For trip table convergence, the percent change threshold was tightened from 10% to 7.5%. For each iteration, only cells where the trips in the current iterations are greater than zero are considered. Also, cells with trips greater than zero are counted as significant trips and form the denominator in the percent converged calculation. A cell in the trip matrix is now considered converged if either of the following conditions is met:</p>
<ul>
<li>The percent change from previous iteration is within 7.5%.</li>
<li>Trips from the current iteration are less than 1, except when trips from the current iteration are greater than zero and the trips from the previous iteration equals zero.</li>
</ul>
<p><strong>Link Convergence</strong></p>
<p>For link volume convergence, the percent change threshold was loosened from 5% to 7.5%. Centroid connectors were removed from consideration when determining convergence. Only cells where the trips in the current iterations are greater than zero are considered and are counted as significant trips forming the denominator in the percent converged calculation. A link is now considered converged if either of the following conditions is met:</p>
<ul>
<li>The percent change from previous iteration is within 7.5%.</li>
<li>Volume from current iteration equals zero and volume from previous iteration equals zero, except when the volume from the current iteration is greater than zero and the volume from the previous iteration equals zero, or the volume from the current iteration is zero and the volume from the previous iteration is greater than zero.</li>
</ul>
<p><strong>Check Criteria</strong></p>
<p>The requirement for a minimum of 5 iterations was removed from the check convergence criteria.</p>
<p><strong>Check Network</strong></p>
<p>A loaded network file (<code>@unloadednetprefix@_@n@_convg.net</code>) was added to <code>Temp\3_Distribute</code> folder to track link convergence between the distribution feedback loop iterations. A network is output for each distribution feedback loop iteration after the first iteration. The link attributes include the volume changes from the current and previous iteration for each time period.</p>
</section>
<section id="rgap-in-distribution" class="level3">
<h3 class="anchored" data-anchor-id="rgap-in-distribution">RGAP in Distribution</h3>
<p>The <code>RelGapCriteria</code> parameter was moved from <code>block\4pd_mainbody_distribution.block</code> to <code>1_Distribution.s</code> and placed before each assignment call in order to accommodate a stricter RGAP threshold for the evening period. For the evening period, the RGAP parameter value is now divided by 10 increasing the network assignment stability and reducing the RMSE for the evening period.</p>
</section>
<section id="reports" class="level3">
<h3 class="anchored" data-anchor-id="reports">Reports</h3>
<p>The following reports were added to the scenarios <code>3_Distribute</code> output folder to better track convergence in the model:</p>
<ul>
<li><code>_Stats - Distrib Assign - @RID@.csv</code> – Combines the highway assignment convergence reports for each feedback loop iteration, time period, and assignment iteration into one file.</li>
<li><code>_Stats - Distrib Loaded Net - @RID@.csv</code> – Provides summary statistics of the number and percent of converged links in the assigned network as well as the total VMT, VHT, and average speed by major functional class (freeways, arterials, and total).</li>
<li><code>_Stats - Distrib Trip Table - @RID@.csv</code> – Provides summary statistics of the number and percent of converged trip table cells as well as the total number of trips by purpose for each feedback loop iteration.</li>
</ul>
</section>
</section>
<section id="mode-choice" class="level2">
<h2 class="anchored" data-anchor-id="mode-choice">Mode Choice</h2>
<section id="mode-name-change" class="level3">
<h3 class="anchored" data-anchor-id="mode-name-change">Mode Name Change</h3>
<p>In version 9, names for the following modes were changed:</p>
<ul>
<li>Mode 5
<ul>
<li>LONGNAME: from ‘Bus Rapid Transit’ to ‘Core Bus’</li>
<li>NAME: from ‘BRT’ to ‘CoreBus’</li>
</ul></li>
<li>Mode 9
<ul>
<li>LONGNAME: from ‘Mode 9 Bus Rapid Transit’ to ‘Bus Rapid Transit’</li>
<li>NAME: from ‘BRT9’ to ‘BRT’</li>
</ul></li>
</ul>
</section>
<section id="prefixes-for-transit-skims" class="level3">
<h3 class="anchored" data-anchor-id="prefixes-for-transit-skims">Prefixes for Transit Skims</h3>
<p>Prefixes to identify transit skim output files have been coded directly into the scripts in version 9. As such, the following parameters were removed from the <code>0_GeneralParameters.block</code> file.</p>
<ul>
<li>W_LCL_skims = ‘skm_w4’ ;walk-to-local skims</li>
<li>D_LCL_skims = ‘skm_d4’ ;drive-to-local skims</li>
<li>W_BRT_skims = ‘skm_w5’ ;walk-to-BRT skims</li>
<li>D_BRT_skims = ‘skm_d5’ ;drive-to-BRT skims</li>
<li>W_EXP_skims = ‘skm_w6’ ;walk-to-express bus skims</li>
<li>D_EXP_skims = ‘skm_d6’ ;drive-to-express bus skims</li>
<li>W_LRT_skims = ‘skm_w7’ ;walk-to-light rail skims</li>
<li>D_LRT_skims = ‘skm_d7’ ;drive-to-light rail skims</li>
<li>W_CRT_skims = ‘skm_w8’ ;walk-to-commuter rail skims</li>
<li>D_CRT_skims = ‘skm_d8’ ;drive-to-commuter rail skims</li>
<li>W_mode9_skims = ‘skm_w9’</li>
<li>D_mode9_skims = ‘skm_d9’</li>
</ul>
</section>
</section>
<section id="assignment" class="level2">
<h2 class="anchored" data-anchor-id="assignment">Assignment</h2>
<section id="diurnal-factors" class="level3">
<h3 class="anchored" data-anchor-id="diurnal-factors">Diurnal Factors</h3>
<p>Diurnal (time-of-day) factors were updated in version 9 for the internal-external (IX) and external-internal (XI) trip purposes based on 2019 StreetLight origin-destination data. IX and XI diurnal factors in version 8 were inherited from previous model versions which were derived using observed truck count data and an averaged factor was used for IX and XI. A comparison of version 8 and 9 IX and XI diurnal factors can be seen in <a href="#tbl-diurnal-fcts">Table&nbsp;1</a>.</p>
<div class="grid">
<div class="g-col-2">

</div>
<div class="g-col-8">
<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display" data-execution_count="1">
<div id="tbl-diurnal-fcts" class="anchored">
<table class="table table-sm table-striped small">
<caption>Table&nbsp;1: IX &amp; XI Diurnal Factors</caption>
<thead>
<tr class="header">
<th style="text-align: left;">Factor</th>
<th style="text-align: left;">v9 Value</th>
<th style="text-align: left;">v8 Value</th>
<th style="text-align: left;">Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">IX_AM_PCT</td>
<td style="text-align: left;">0.1909</td>
<td style="text-align: left;">0.1786</td>
<td style="text-align: left;">0.0123</td>
</tr>
<tr class="even">
<td style="text-align: left;">IX_MD_PCT</td>
<td style="text-align: left;">0.3136</td>
<td style="text-align: left;">0.3291</td>
<td style="text-align: left;">-0.0155</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IX_PM_PCT</td>
<td style="text-align: left;">0.2567</td>
<td style="text-align: left;">0.2604</td>
<td style="text-align: left;">-0.0037</td>
</tr>
<tr class="even">
<td style="text-align: left;">IX_EV_PCT</td>
<td style="text-align: left;">0.2388</td>
<td style="text-align: left;">0.2319</td>
<td style="text-align: left;">0.0069</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XI_AM_PCT</td>
<td style="text-align: left;">0.1969</td>
<td style="text-align: left;">0.1786</td>
<td style="text-align: left;">0.0183</td>
</tr>
<tr class="even">
<td style="text-align: left;">XI_MD_PCT</td>
<td style="text-align: left;">0.3263</td>
<td style="text-align: left;">0.3291</td>
<td style="text-align: left;">-0.0028</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XI_PM_PCT</td>
<td style="text-align: left;">0.2617</td>
<td style="text-align: left;">0.2604</td>
<td style="text-align: left;">0.0013</td>
</tr>
<tr class="even">
<td style="text-align: left;">XI_EV_PCT</td>
<td style="text-align: left;">0.2151</td>
<td style="text-align: left;">0.2319</td>
<td style="text-align: left;">-0.0168</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IX_AM_PA</td>
<td style="text-align: left;">0.6604</td>
<td style="text-align: left;">0.8563</td>
<td style="text-align: left;">-0.1959</td>
</tr>
<tr class="even">
<td style="text-align: left;">IX_MD_PA</td>
<td style="text-align: left;">0.5593</td>
<td style="text-align: left;">0.5627</td>
<td style="text-align: left;">-0.0034</td>
</tr>
<tr class="odd">
<td style="text-align: left;">IX_PM_PA</td>
<td style="text-align: left;">0.4044</td>
<td style="text-align: left;">0.3288</td>
<td style="text-align: left;">0.0756</td>
</tr>
<tr class="even">
<td style="text-align: left;">IX_EV_PA</td>
<td style="text-align: left;">0.3968</td>
<td style="text-align: left;">0.329</td>
<td style="text-align: left;">0.0678</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XI_AM_PA</td>
<td style="text-align: left;">0.7709</td>
<td style="text-align: left;">0.8563</td>
<td style="text-align: left;">-0.0854</td>
</tr>
<tr class="even">
<td style="text-align: left;">XI_MD_PA</td>
<td style="text-align: left;">0.6087</td>
<td style="text-align: left;">0.5627</td>
<td style="text-align: left;">0.046</td>
</tr>
<tr class="odd">
<td style="text-align: left;">XI_PM_PA</td>
<td style="text-align: left;">0.3111</td>
<td style="text-align: left;">0.3288</td>
<td style="text-align: left;">-0.0177</td>
</tr>
<tr class="even">
<td style="text-align: left;">XI_EV_PA</td>
<td style="text-align: left;">0.317</td>
<td style="text-align: left;">0.329</td>
<td style="text-align: left;">-0.012</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<p>Diurnal factors were removed from the <code>0_GeneralParameters.block</code> file in version 9 and are now read in via an input file (<code>1_Inputs\0_GlobalData\5_Assignment\Time Of Day Factors.csv</code>). A source spreadsheet (<code>_source - Time Of Day Factors.xlsb</code>) is also included in the input folder. The new factors file includes factors for additional trip purposes (e.g.&nbsp;home-based college stratified by campus), although the model code has not yet been modified to account for the additional factors.</p>
<p>A new script (<code>2_ModelScripts\0_InputProcessing\e_TimeOfDayFactors\1_CalculateTimeOfDayFac.s</code>) was added to the model stream, which included an update to the “HailMary.s” script. This script reads in the <code>Time Of Day Factors.csv</code> file and writes out a text file (<code>0_InputProcessing\_TimeOfDayFactors.txt</code>) containing the diurnal factors expressed as parameters for use in the model. Scripts that use diurnal parameters in version 9 were updated to read in the text file containing the diurnal parameters.</p>
</section>
<section id="rgap-in-assignment" class="level3">
<h3 class="anchored" data-anchor-id="rgap-in-assignment">RGAP in Assignment</h3>
<p>The “RelGapCriteria” parameter was moved from the <code>block\4pd_mainbody_managedlanes.block</code> and <code>4pd_mainbody_managedlanes_SelectLink.block</code> files and placed in the <code>02_Assign_AM_MD_PM_EV.s</code> and <code>03_Assign_PM1Hr.s</code> scripts to accommodate a stricter RGAP threshold for the evening period. For the evening period, the RGAP parameter value is now divided by 10 increasing the network assignment stability and reducing the RMSE for the evening period.</p>
</section>
<section id="assigned-network" class="level3">
<h3 class="anchored" data-anchor-id="assigned-network">Assigned Network</h3>
<p>Medium and heavy truck speed and time and buffer time index (BTI) calculations were added to the <code>04_SummarizeLoadedNetworks.s</code> script (calculations were previously in the <code>5_AssignHwy\07_PerformFinalNetSkim.s</code> script). Weighted average daily summaries were also added. The following fields were added to the assigned output network:</p>
<ul>
<li>Weighted average daily values for:
<ul>
<li>Ramp Penalties (DY_RAMPPEN)</li>
<li>Buffer Time Index (DY_BTI_TME)</li>
</ul></li>
<li>Medium Truck Speed
<ul>
<li>FF_TKSPD_M</li>
<li>AM_TKSPD_M</li>
<li>MD_TKSPD_M</li>
<li>PM_TKSPD_M</li>
<li>EV_TKSPD_M</li>
<li>DY_TKSPD_M</li>
</ul></li>
<li>Medium Truck Time
<ul>
<li>FF_TKTME_M</li>
<li>AM_TKTME_M</li>
<li>MD_TKTME_M</li>
<li>PM_TKTME_M</li>
<li>EV_TKTME_M</li>
<li>DY_TKTME_M</li>
</ul></li>
<li>Heavy Truck Speed
<ul>
<li>FF_TKSPD_H</li>
<li>AM_TKSPD_H</li>
<li>MD_TKSPD_H</li>
<li>PM_TKSPD_H</li>
<li>EV_TKSPD_H</li>
<li>DY_TKSPD_H</li>
</ul></li>
<li>Heavy Truck Time
<ul>
<li>FF_TKTME_H</li>
<li>AM_TKTME_H</li>
<li>MD_TKTME_H</li>
<li>PM_TKTME_H</li>
<li>EV_TKTME_H</li>
<li>DY_TKTME_H</li>
</ul></li>
</ul>
<p>The following fields were removed from the assigned output network:</p>
<ul>
<li>lw_Spd_Auto_1</li>
<li>lw_TrkSpd_MD_1</li>
<li>lw_TrkSpd_HV_1</li>
<li>lw_Time_Auto_1</li>
<li>lw_TrkTime_MD_1</li>
<li>lw_TrkTime_HV_1</li>
</ul>
</section>
<section id="final-skims" class="level3">
<h3 class="anchored" data-anchor-id="final-skims">Final Skims</h3>
<p>The <code>5_AssignHwy\07_PerformFinalNetSkim.s</code> script was updated in version 9 to include ramp penalty information for general purpose (GP), managed lane (ML), medium truck (MD), and heavy truck (HV) for each time period. The version 9 script also produces a daily skim matrix with the same attributes as the period skim matrices.</p>
</section>
<section id="reports-1" class="level3">
<h3 class="anchored" data-anchor-id="reports-1">Reports</h3>
<p>The following report was added to the scenarios <code>5_AssignHwy\0_ConvergeReports</code> output folder to better track convergence in the model:</p>
<ul>
<li><code>_Stats - Final Assign - @RID@.csv</code> – Combines the highway assignment convergence reports for each time period and assignment iteration into one file.</li>
</ul>
</section>
</section>
<section id="miscellaneous-updates" class="level2">
<h2 class="anchored" data-anchor-id="miscellaneous-updates">Miscellaneous Updates</h2>
<p>The following changes were also made to the model in version 9:</p>
<ul>
<li>The following parameters were removed from the <code>0_GeneralParameters.block</code> file in version 9 because they were no longer being used in the model. These are in addition to the other parameter changes identified in other sections of this report.
<ul>
<li>County Identification Parameters
<ul>
<li>CountyRange = ‘1-5’</li>
<li>CountyName1 = ‘Weber’</li>
<li>CountyName2 = ‘Davis’</li>
<li>CountyName3 = ‘SaltLake’</li>
<li>CountyName4 = ‘Utah’</li>
<li>CountyName5 = ‘BoxElder’</li>
<li>CO_Name1 = ‘WE’</li>
<li>CO_Name2 = ‘DA’</li>
<li>CO_Name3 = ‘SL’</li>
<li>CO_Name4 = ‘UT’</li>
<li>CO_Name5 = ‘BE’</li>
</ul></li>
<li>Air Quality Conformity Report Parameters
<ul>
<li>RE_ID = 0 ;Entire region</li>
<li>WE_ID = 1 ;Weber</li>
<li>DA_ID = 2 ;Davis</li>
<li>SL_ID = 3 ;Salt Lake</li>
<li>UT_ID = 4 ;Utah</li>
<li>BE_ID = 5 ;BoxElder</li>
<li>OC_ID = 55980 ;Ogden</li>
<li>SC_ID = 67000 ;Salt Lake City</li>
<li>PC_ID = 62470 ;Provo</li>
</ul></li>
<li>Assignment Type Flag
<ul>
<li>AssignType = ‘managed’</li>
</ul></li>
</ul></li>
<li>The folder setup routine was integrated into the <code>HailMary.s</code> script to run automatically. It is no longer necessary to copy empty folders or run the <code>_CreateOutputFolders.s</code> prior to running the model.</li>
<li>The <code>3_Distribute\1_Distribution.s</code> script was updated so that initializing the summary statistics variables that will be printed to the log file is no longer needed and the section to initialize these variables was removed. In addition, the trip table and link convergence reports in the log file were updated based on information generated in the new summary statistics reports.</li>
<li>The <code>04_SummarizeLoadedNetworks.s</code> script was modified to point the geometry input reference to the input processing output folder instead of the highway inputs folder.</li>
<li>The <code>PrintProgress</code> code block found in various scripts throughout the model was updated to account for multithread processing. This code block provides percent complete progress updates for specific, matrix-based Voyager modules.</li>
</ul>
<section id="bug-fixes" class="level3">
<h3 class="anchored" data-anchor-id="bug-fixes">Bug Fixes</h3>
<ul>
<li>A bug in the Connected and Autonomous Vehicle (CAV) calculation was fixed where the column index needed to be incremented by 1 to link up with lookup tables.</li>
<li>A bug was fixed in the portion of the “04_SummarizeLoadedNetworks.s” script that consolidates the select link trip tables. The total trips were being summarized into a matrix that was not being assigned to the output matrix. The correct working matrices have been updated with the correct index for the output file.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left"><a href="https://wfrc.org"><img src="https://wfrc.org/wp-content/uploads/2021/11/logo.jpg" class="img-fluid" alt="WFRC" width="150"></a> <a href="https://mountainland.org/"><img src="https://mountainland.org/static/media/logo/svg/MAG_Logo_Horz_NoTag.svg" class="img-fluid" alt="MAG" width="65"></a></div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Built using <a href="https://quarto.org">Quarto</a></div>
  </div>
</footer>



</body></html>